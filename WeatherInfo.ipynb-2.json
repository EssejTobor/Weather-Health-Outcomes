{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Dependencies\n",
    "import csv\n",
    "import matplotlib.pyplot as plt\n",
    "import openweathermapy as ow\n",
    "import pandas as pd\n",
    "import numpy as np "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>City Name</th>\n",
       "      <th>Temperature</th>\n",
       "      <th>Lowest Temp</th>\n",
       "      <th>Highest Temp</th>\n",
       "      <th>Snow 24h</th>\n",
       "      <th>Clouds All</th>\n",
       "      <th>Weather</th>\n",
       "      <th>Weather Description</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.47</td>\n",
       "      <td>42.80</td>\n",
       "      <td>44.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>scattered clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.47</td>\n",
       "      <td>42.80</td>\n",
       "      <td>44.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>40</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>scattered clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.20</td>\n",
       "      <td>42.08</td>\n",
       "      <td>44.96</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>42.98</td>\n",
       "      <td>42.08</td>\n",
       "      <td>44.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>42.53</td>\n",
       "      <td>41.00</td>\n",
       "      <td>44.06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Year     City Name  Temperature  Lowest Temp  Highest Temp  Snow 24h  \\\n",
       "0  2016  Philadelphia        43.47        42.80         44.06       NaN   \n",
       "1  2016  Philadelphia        43.47        42.80         44.06       NaN   \n",
       "2  2016  Philadelphia        43.20        42.08         44.96       NaN   \n",
       "3  2016  Philadelphia        42.98        42.08         44.06       NaN   \n",
       "4  2016  Philadelphia        42.53        41.00         44.06       NaN   \n",
       "\n",
       "   Clouds All Weather Weather Description  \n",
       "0          40  Clouds    scattered clouds  \n",
       "1          40  Clouds    scattered clouds  \n",
       "2          90  Clouds     overcast clouds  \n",
       "3          90  Clouds     overcast clouds  \n",
       "4          90  Clouds     overcast clouds  "
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_df = pd.read_csv (r'/Users/lauraehallaman/Documents/GitHub/Weather-Health-Outcomes/WeatherInfo.csv')\n",
    "weather_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>City Name</th>\n",
       "      <th>Temperature</th>\n",
       "      <th>Lowest Temp</th>\n",
       "      <th>Highest Temp</th>\n",
       "      <th>Snow 24h</th>\n",
       "      <th>Clouds All</th>\n",
       "      <th>Weather</th>\n",
       "      <th>Weather Description</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.47</td>\n",
       "      <td>42.80</td>\n",
       "      <td>44.06</td>\n",
       "      <td>0.0</td>\n",
       "      <td>40</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>scattered clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.47</td>\n",
       "      <td>42.80</td>\n",
       "      <td>44.06</td>\n",
       "      <td>0.0</td>\n",
       "      <td>40</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>scattered clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>43.20</td>\n",
       "      <td>42.08</td>\n",
       "      <td>44.96</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>42.98</td>\n",
       "      <td>42.08</td>\n",
       "      <td>44.06</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>2016</td>\n",
       "      <td>Philadelphia</td>\n",
       "      <td>42.53</td>\n",
       "      <td>41.00</td>\n",
       "      <td>44.06</td>\n",
       "      <td>0.0</td>\n",
       "      <td>90</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>overcast clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>179874</td>\n",
       "      <td>2017</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>63.10</td>\n",
       "      <td>59.00</td>\n",
       "      <td>69.98</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75</td>\n",
       "      <td>Mist</td>\n",
       "      <td>mist</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>179875</td>\n",
       "      <td>2017</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>66.36</td>\n",
       "      <td>62.06</td>\n",
       "      <td>71.60</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75</td>\n",
       "      <td>Mist</td>\n",
       "      <td>mist</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>179876</td>\n",
       "      <td>2017</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>69.10</td>\n",
       "      <td>62.60</td>\n",
       "      <td>80.60</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>broken clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>179877</td>\n",
       "      <td>2017</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>66.47</td>\n",
       "      <td>62.06</td>\n",
       "      <td>71.60</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>broken clouds</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>179878</td>\n",
       "      <td>2017</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>66.11</td>\n",
       "      <td>62.06</td>\n",
       "      <td>69.80</td>\n",
       "      <td>0.0</td>\n",
       "      <td>75</td>\n",
       "      <td>Clouds</td>\n",
       "      <td>broken clouds</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>179879 rows Ã— 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Year     City Name  Temperature  Lowest Temp  Highest Temp  Snow 24h  \\\n",
       "0       2016  Philadelphia        43.47        42.80         44.06       0.0   \n",
       "1       2016  Philadelphia        43.47        42.80         44.06       0.0   \n",
       "2       2016  Philadelphia        43.20        42.08         44.96       0.0   \n",
       "3       2016  Philadelphia        42.98        42.08         44.06       0.0   \n",
       "4       2016  Philadelphia        42.53        41.00         44.06       0.0   \n",
       "...      ...           ...          ...          ...           ...       ...   \n",
       "179874  2017     San Diego        63.10        59.00         69.98       0.0   \n",
       "179875  2017     San Diego        66.36        62.06         71.60       0.0   \n",
       "179876  2017     San Diego        69.10        62.60         80.60       0.0   \n",
       "179877  2017     San Diego        66.47        62.06         71.60       0.0   \n",
       "179878  2017     San Diego        66.11        62.06         69.80       0.0   \n",
       "\n",
       "        Clouds All Weather Weather Description  \n",
       "0               40  Clouds    scattered clouds  \n",
       "1               40  Clouds    scattered clouds  \n",
       "2               90  Clouds     overcast clouds  \n",
       "3               90  Clouds     overcast clouds  \n",
       "4               90  Clouds     overcast clouds  \n",
       "...            ...     ...                 ...  \n",
       "179874          75    Mist                mist  \n",
       "179875          75    Mist                mist  \n",
       "179876          75  Clouds       broken clouds  \n",
       "179877          75  Clouds       broken clouds  \n",
       "179878          75  Clouds       broken clouds  \n",
       "\n",
       "[179879 rows x 9 columns]"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_df=weather_df.fillna(0)\n",
    "weather_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_df.to_csv(\"/Users/lauraehallaman/Desktop/Project1/Weather-Health-Outcomes/Philly2016.csv\", encoding=\"utf-8\", index=False, header=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>Temperature</th>\n",
       "      <th>Snow 24h</th>\n",
       "      <th>Clouds All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>City Name</th>\n",
       "      <th>Year</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Benavides</td>\n",
       "      <td>2016</td>\n",
       "      <td>73.409796</td>\n",
       "      <td>0.00</td>\n",
       "      <td>36.120478</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>73.689338</td>\n",
       "      <td>40.84</td>\n",
       "      <td>36.649519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Chicago</td>\n",
       "      <td>2016</td>\n",
       "      <td>52.721913</td>\n",
       "      <td>75.59</td>\n",
       "      <td>60.508055</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>52.685604</td>\n",
       "      <td>44.46</td>\n",
       "      <td>60.610915</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Dallas</td>\n",
       "      <td>2016</td>\n",
       "      <td>68.133099</td>\n",
       "      <td>0.30</td>\n",
       "      <td>49.633008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>68.123393</td>\n",
       "      <td>14.73</td>\n",
       "      <td>52.041099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Houston</td>\n",
       "      <td>2016</td>\n",
       "      <td>71.979413</td>\n",
       "      <td>0.00</td>\n",
       "      <td>35.130593</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>72.198964</td>\n",
       "      <td>9.32</td>\n",
       "      <td>37.740940</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Los Angeles</td>\n",
       "      <td>2016</td>\n",
       "      <td>64.982821</td>\n",
       "      <td>0.00</td>\n",
       "      <td>28.056648</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>65.295007</td>\n",
       "      <td>0.00</td>\n",
       "      <td>27.568480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">New York</td>\n",
       "      <td>2016</td>\n",
       "      <td>56.721083</td>\n",
       "      <td>140.49</td>\n",
       "      <td>38.932327</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>56.192300</td>\n",
       "      <td>85.02</td>\n",
       "      <td>40.148791</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Philadelphia</td>\n",
       "      <td>2016</td>\n",
       "      <td>55.857598</td>\n",
       "      <td>83.89</td>\n",
       "      <td>56.779268</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>55.623532</td>\n",
       "      <td>63.84</td>\n",
       "      <td>60.037795</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">Phoenix</td>\n",
       "      <td>2016</td>\n",
       "      <td>75.438591</td>\n",
       "      <td>0.00</td>\n",
       "      <td>34.020079</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>76.009276</td>\n",
       "      <td>0.00</td>\n",
       "      <td>36.581692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">San Antonio</td>\n",
       "      <td>2016</td>\n",
       "      <td>70.162125</td>\n",
       "      <td>0.27</td>\n",
       "      <td>40.333185</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>71.154626</td>\n",
       "      <td>6.66</td>\n",
       "      <td>39.078048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td rowspan=\"2\" valign=\"top\">San Diego</td>\n",
       "      <td>2016</td>\n",
       "      <td>64.784996</td>\n",
       "      <td>0.00</td>\n",
       "      <td>50.598650</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2017</td>\n",
       "      <td>64.890548</td>\n",
       "      <td>0.00</td>\n",
       "      <td>50.199571</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   Temperature  Snow 24h  Clouds All\n",
       "City Name    Year                                   \n",
       "Benavides    2016    73.409796      0.00   36.120478\n",
       "             2017    73.689338     40.84   36.649519\n",
       "Chicago      2016    52.721913     75.59   60.508055\n",
       "             2017    52.685604     44.46   60.610915\n",
       "Dallas       2016    68.133099      0.30   49.633008\n",
       "             2017    68.123393     14.73   52.041099\n",
       "Houston      2016    71.979413      0.00   35.130593\n",
       "             2017    72.198964      9.32   37.740940\n",
       "Los Angeles  2016    64.982821      0.00   28.056648\n",
       "             2017    65.295007      0.00   27.568480\n",
       "New York     2016    56.721083    140.49   38.932327\n",
       "             2017    56.192300     85.02   40.148791\n",
       "Philadelphia 2016    55.857598     83.89   56.779268\n",
       "             2017    55.623532     63.84   60.037795\n",
       "Phoenix      2016    75.438591      0.00   34.020079\n",
       "             2017    76.009276      0.00   36.581692\n",
       "San Antonio  2016    70.162125      0.27   40.333185\n",
       "             2017    71.154626      6.66   39.078048\n",
       "San Diego    2016    64.784996      0.00   50.598650\n",
       "             2017    64.890548      0.00   50.199571"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_df = weather_df.loc[:,[\"City Name\",\"Year\",\"Temperature\",\"Snow 24h\",\"Clouds All\"]].groupby([\"City Name\",\"Year\"]).agg({\"Temperature\":\"mean\",\"Snow 24h\":\"sum\",\"Clouds All\":\"mean\"})\n",
    "all_df.head(100)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "all_df.to_csv(\"/Users/lauraehallaman/Desktop/Project1/Weather-Health-Outcomes/AllDf.csv\", encoding=\"utf-8\", index=False, header=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
